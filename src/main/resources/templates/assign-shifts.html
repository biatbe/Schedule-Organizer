<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Assign Shifts</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link rel="stylesheet" type="text/css" href="/header.css">
    <link rel="stylesheet" type="text/css" href="/assign-shifts.css">
</head>
<body>
<div th:replace="fragments/header :: header"></div>
<div class="site-container">
    <div class="site-left">
        <h1>Assign Shifts to Days</h1>
        <form action="/api/v1/assign-shifts" method="post" >
            <label for="shift">Choose a Shift:</label>
            <select id="shift" name="shift">
                <option th:each="shift : ${shifts}" th:value="${shift.shiftId}" th:text="${shift.shiftType
                 + ' (' + shift.startTime + ' - ' + shift.endTime + ')'}"4></option>
            </select><br><br>

            <label>Assign to Specific Day:</label>
            <input type="date" id="specificDay" name="specificDay"><br><br>

            <label>Assign to Day of the Week:</label>
            <select id="dayOfWeek" name="dayOfWeek" >
                <option value="MONDAY">Monday</option>
                <option value="TUESDAY">Tuesday</option>
                <option value="WEDNESDAY">Wednesday</option>
                <option value="THURSDAY">Thursday</option>
                <option value="FRIDAY">Friday</option>
                <option value="SATURDAY">Saturday</option>
                <option value="SUNDAY">Sunday</option>
            </select><br><br>

            <button type="submit">Assign Shift</button>
        </form>
    </div>
    <div class="site-right">
        <table id="day-data">
            <tr><td>Current shifts on the chosen day:</td></tr>

        </table>
    </div>
</div>
<script>
    $('#specificDay').change(function() {
        const selectedDay = $(this).val(); // Get the selected day
        if (selectedDay) {
            $('#day-data').empty();
            // Make AJAX request to fetch data for selected day
            $.ajax({
                url: '/api/v1/assign-shifts/day?day=' + selectedDay,
                type: 'GET',
                success: function(data) {
                    let newInput = '<tr><td>' + data.day + '</td></tr>';
                    $.each(data.dayShifts, function(index, items) {
                        newInput += '<tr><td>' + items.shift.shiftType + " (" + items.shift.startTime
                            + " - " + items.shift.endTime + ")" + '</td></tr>';
                    });
                    $('#day-data').append(newInput);
                },
                error: function(xhr, status, error) {
                    console.error('Error fetching data:', error);
                }
            });
        }
    });
</script>
</body>
</html>